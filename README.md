# 学習プランツール

場所: `optimal_study_plan/src/plan_gui.py`

## 概要

`plan_gui.py` は Tkinter ベースの簡易 GUI です。主な機能は以下です。

- 新規の学習プランを作成して日別にタスクを割り当てる。
- 既存の CSV プランを読み込み、「今日」を適用して完了数を反映し、残りを再計画する（リプラン）。
- 生成／再計画したプランを CSV で保存する。

本リポジトリは標準ライブラリのみで動作するように作られています。

## 前提／準備

- Python 3.8 以上（推奨）。
- 作業ディレクトリの例: `c:\Users\akira\personal-project\optimal_study_plan`。
- GUI 実行に追加ライブラリは不要（Tkinter は標準で同梱されていることが多いです）。

## 起動方法（PowerShell）

```powershell
python "c:\Users\akira\personal-project\optimal_study_plan\src\plan_gui.py"
```

GUI が起動しない場合は、まず `python --version` を実行してインタプリタを確認してください。

## GUI の使い方（詳しい手順）

### タブ: 新規プラン

1. **科目** に文字列を入力します（例: `英語`）。
2. **開始日** に `YYYY-MM-DD` 形式で入力すると、表示に日付が付加されます（未入力時は表示に日付を付けません）。
3. **テスト日**（任意）はメタ情報として保存されます（表示にも使えます）。
4. **1問あたり共通時間** に、全タスクで共通に使う1問当たり時間（時間単位）を入れます。個別に違う場合は後で手動編集してください。
5. **日ごとの利用可能時間** はカンマ区切りで各日の学習可能時間を入力します（例: `2,2.5,3` = 1日目2h, 2日目2.5h, 3日目3h）。
6. **タスク** はテキストエリアに1行1タスクで記入します。フォーマット: `名前,合計問題数,優先順位,問題コスト(倍率)`。
   - 例: `英語長文,20,1,1.0`。ここで優先順位は数値（小さいほど高優先）、問題コストはその問題の所要比率（デフォルト1.0）。
7. **プリセット読み込み** を押すと、`first_study_plan.py` に定義されたプリセットがあれば各フィールドへ挿入します（無ければ無視）。
8. **プラン生成** を押すと右側に日別割当が表示されます。表示は日ごとのタスク名、割当数、所要時間（時間）を示します。
9. 必要なら **プラン保存 (CSV)** でファイル名を指定して保存します（`plans/` フォルダがデフォルトの保存先です）。

### タブ: CSVから更新（再計画）

1. **CSV読み込み** ボタンで既存のプラン CSV を選択します（GUI は上部のメタと `Plan` セクションを読み取ります）。
2. **今日 (Day#)** に、読み込んだプランのどの日を「今日」とするかを数値で入力します（例: `1` = Day1 が今日）。
3. **今日を適用して再計画** を押すと、各タスクについて「今日の完了数」を尋ねるダイアログが順に出ます。提案値（今日割当など）をデフォルトとして表示します。
4. 続けて、再計画に使う「次の日の利用可能時間」をカンマ区切りで入力します（例: `2,3,2`）。これに対して再割当を行います。
5. 再計画は「再計画分（入力した next_caps に対する割当）」と「元プランの、今日以降に残った日程」を結合して表示します（元プランの残り日程がある場合）。
6. 表示を確認後、保存を選べます。保存すると再計画結果を CSV 形式で出力します。

## CSV 形式（例と説明）

GUI が読み書きする CSV は次のような構成を想定しています（簡易的な例）:

```csv
subject,英語
generated_at,2025-12-01T12:00:00
total_available,20.00
total_needed,18.50
start_date,2025-12-01
test_date,2026-01-10

Day Capacities
Day,AvailableHours
1,2.00
2,2.50

Plan
Day,Task,Assigned,Time(hours)
1,英語長文,3,1.50
1,英単語,10,2.00
2,(休憩/学習無し),,,
```

- 上部のメタ行はキー,値 の単純な行が続きます（`subject`, `generated_at` など）。
- `Day Capacities` ブロックは各日（Day番号）と利用可能時間を並べます。
- `Plan` ブロックは `Day,Task,Assigned,Time(hours)` のヘッダを持ち、各行が日ごとの割当を示します。

GUI は多少のフォーマットゆらぎに寛容ですが、列順や見出しが変わると読み込みが失敗する可能性があります。

## 具体的なワークフロー例

### 新規プラン作成

1. `新規プラン` タブでタスクと日数を入力。
2. `プラン生成` を押して割当を確認。
3. 問題数や開始日を微調整して再生成。
4. `プラン保存 (CSV)` で `plans/` に保存。

### 再計画（CSVから更新）

1. `CSVから更新` タブで既存プランを読み込む。
2. `今日 (Day#)` を指定し、`今日を適用して再計画` を押す。
3. タスクごとの今日完了数を入力。
4. 再計画に使う次の日の利用時間を入力して再生成。
5. 必要なら保存。

## よくあるトラブルと対処

- ウィンドウが開かない／クラッシュする: Tkinter が利用できない、または Python 環境の問題です。Python REPL で `import tkinter` をしてエラーが出るか確認してください。
- CSV 読み込みで値が欠ける／解釈できない: `Plan` ブロックのヘッダ行が欠けていないか、カンマ区切りが正しいか確認してください。
- 日付表示が期待と違う: `start_date` を `YYYY-MM-DD` 形式で入力してください（GUI は ISO 形式を使ってパースします）。

## 主要ファイルと配置

- `src/plan_gui.py` : GUI 本体
- `src/first_study_plan.py` : プリセット／割当ロジックの参照先
- `src/done_task.py` : CLI ベースの再計画ユーティリティ（併用可能）
- `plans/` : CSV の既定保存先（GUI 起動時に自動作成されます）

## 今後の改善案（提案）

1. タスクを行単位で編集できる表形式エディタを追加。
2. GUI の表示を Treeview にして折りたたみ可能にする。
3. 保存済み CSV の履歴管理と自動バックアップを追加。

---

必要であれば、サンプル CSV（`plans/sample_plan.csv`）やクイックスタート短縮版 README を追加できます。どれを作りましょうか？
# 学習プランツール

場所: `optimal_study_plan/src/plan_gui.py`

## 概要

`plan_gui.py` は Tkinter ベースの簡易 GUI です。新規プランの生成と、既存の CSV プランを読み込んで「今日」を適用し再計画（リプラン）する機能を持ちます。出力は CSV で保存できます。

## 準備


## 起動方法 (PowerShell)

```powershell
python "c:\Users\akira\personal-project\optimal_study_plan\src\plan_gui.py"
```

## GUI の使い方（要点）

### タブ: 新規プラン

  - フィールド順: `名前,合計問題数,優先順位,問題コスト(倍率)`。

### タブ: CSVから更新


## CSV 形式（概要）


## よくあるトラブルと対処


## 次にできる改善（提案）


もし README に追加したいスクリーンショットやサンプル CSV があれば貼ってください。必要なら README を英語版でも作成します。
